<!doctype html>
<html lang="en" class="dark">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MoQ Demo (MSE)</title>

	<link rel="stylesheet" href="index.css">
	<link rel="icon" type="image/svg+xml" href="/favicon.svg">
</head>

<body class="dark:bg-black p-4">
	<!-- Show if this browser supports everything we need. -->
	<hang-support mode="watch" show="partial"></hang-support>

	<!--
		This demo uses MSE (Media Source Extensions) instead of WebCodecs.
		MSE has broader device support but higher latency compared to the WebCodecs canvas renderer.

		The relay url is loaded from an environment as it contains a generated JWT authentication token.
		Feel free to hard-code it if you have public access configured, like `url="https://cdn.moq.dev/anon"`
		NOTE: `http` performs an insecure certificate check. You must use `https` in production.

		The broadcast path is overwritten by the ?path query parameter in index.ts.

		NOTE: `reload` will detect when the broadcast goes offline/online and automatically reconnect.
		TODO: Cloudflare doesn't support it yet (SUBSCRIBE_NAMESPACE), so make sure you remove it if you're using Cloudflare.
	-->
	<hang-watch-ui>
		<hang-watch id="watch" url="%VITE_RELAY_URL%" path="bbb" muted buffer="150" reload>
			<video style="width: 100%; height: auto;" autoplay muted></video>
		</hang-watch>
	</hang-watch-ui>

	<!-- Configure the relay URL and broadcast name. Auto-discovers available broadcasts. -->
	<hang-config id="config" url="%VITE_RELAY_URL%" path="bbb"></hang-config>

	<h3>Other demos:</h3>
	<ul>
		<li><a href="index.html">Watch a broadcast (WebCodecs).</a></li>
		<li><a href="publish.html">Publish a broadcast.</a></li>
		<li><a href="meet.html">Watch a room of broadcasts.</a></li>
		<li><a href="support.html">Check browser support.</a></li>
	</ul>

	<h3>Tips:</h3>
	<p>
		This demo uses <a href="https://developer.mozilla.org/en-US/docs/Web/API/Media_Source_Extensions_API">MSE (Media
			Source Extensions)</a>
		via a <code>&lt;video&gt;</code> element instead of WebCodecs via <code>&lt;canvas&gt;</code>.
		MSE has broader device support but higher latency.
	</p>
	<p>
		To use MSE, provide a <code>&lt;video&gt;</code> element instead of a <code>&lt;canvas&gt;</code> element:
	<pre><code class="language-html">&lt;hang-watch url="https://cdn.moq.dev/anon" path="bbb"&gt;
	&lt;video style="max-width: 100%; height: auto;" autoplay muted&gt;&lt;/video&gt;
&lt;/hang-watch&gt;</code></pre>
	</p>
</body>

<script type="module" src="index.ts"></script>

</html>
